{% extends 'base.html' %}
{% load cache %}

{% block title %}
    {% if conf %}{{ conf }}{% else %}RankFoot.com{% endif %} - Live FIFA Rankings: Daily Updates
{% endblock %}

{% block og-title %}RankFoot - Live FIFA Rankings: Daily Updates {% if conf %} - {{ conf }}{% endif %}{% endblock %}
{% block og-description %}Stay updated with RankFoot's live FIFA Men's Football Rankings. Get daily updates on national team standings, track performance changes in real-time, and follow the latest movements in global football rankings.{% endblock %}
{% block og-url %}{{ request.build_absolute_uri }}{% endblock %}

{% block content %}
    <style>
      @media (max-width: 768px) {
        /* Asosiy konteyner */
        .col-lg-8 {
          padding: 0 !important;
        }
        /* Konfederatsiya filtrlari */
        .py-3 {
          display: flex !important;
          flex-wrap: wrap !important;
          justify-content: center !important;
        }
        .py-3 a {
          margin: 2px !important;
          font-size: 0.8rem !important;
          padding: 2px 4px !important;
        }
        /* Jadval */
        .table {
          font-size: 0.9rem !important;
        }
        .table td {
          padding: 0.3rem !important;
        }
        /* Rank ustuni */
        .table td:first-child {
          padding-left: 0 !important;
          width: 50px !important;
        }
        .table td:first-child span {
          font-size: 0.8rem !important;
          padding: 2px 4px !important;
        }
        /* Bayroq rasmlari */
        .table td:nth-child(3) img {
          width: 24px !important;
          height: 16px !important;
        }
        /* Mamlakat nomi */
        .table td:nth-child(4) span {
          font-size: 0.85rem !important;
        }
        /* Ochkolar ustuni */
        .table td:nth-child(5),
        .table td:nth-child(6) {
          font-size: 0.8rem !important;
        }
        /* Info tugmasi */
        .table td:last-child {
          padding-right: 0 !important;
        }
        .table td:last-child button {
          font-size: 0.8rem !important;
          padding: 0 !important;
          width: 18px !important;
          height: 18px !important;
        }
        /* Paginator */
        .text-center.mb-4 {
          margin-top: 1rem !important;
        }
        .text-center.mb-4 a {
          font-size: 0.9rem !important;
          padding: 2px 6px !important;
        }
      }
    </style>

    <div class="col-lg-8 m-auto mt-5">
        <h1 class="text-center fs-3"  style="color: #1F51FF">{% if conf %}<span class="fw-normal">{{ conf }} - </span>{% endif %}Live FIFA Rankings: Daily Updates</h1>
        <h2 class="text-center fw-normal fs-6">{% if conf %}Latest {{ conf }} Team Rankings: Updated Daily{% else %} Live FIFA Rankings: Real-Time Updates and Daily Changes{% endif %}</h2>
        <hr>
        <div class="col-lg-6 m-auto">
        <select name="period"
                class="form-control text-center form-control-sm py-0"
                style="font-size: 0.95rem; border: 1px solid #1F51FF"
                onchange="location.href=`{% url "ranking" %}?period=${this.value}`">
            {% for per in periods %}
            <option value="{{ per.id }}"
                    {% if request.GET.period == per.id|stringformat:"s" or not request.GET.period and period.id|stringformat:"s" == per.id|stringformat:"s" %}selected="selected"{% endif %}>
                {{ per }}
            </option>
            {% endfor %}
        </select>
        </div>
        <p class="text-center fs-6 py-3">
            <a class="mx-1" href="{% url 'ranking' %}"
                   style="font-size: 0.95rem; text-decoration: none; font-weight: 500; color: white; padding: 3px 6px; background: #5F91FF; border-radius: 5px; line-height: 1; width: 100px !important; {% if not conf %}background: #1F51FF !important;{% endif %}">
                ALL
            </a>
            {% for confederation in confederations %}
                <a class="mx-1" href="{% url 'conf-ranking' confederation.0 %}"
                   style="font-size: 0.95rem; text-decoration: none; font-weight: 500; color: white; padding: 3px 6px; background: #5F91FF; border-radius: 5px; line-height: 1; width: 100px !important; {% if conf == confederation.0 %}background: #1F51FF !important;{% endif %}">
                    {{ confederation.0 }}
                </a>
            {% endfor %}
        </p>
{#    {% cache 500 table conf request.GET.page %}#}
        <table class="table table-responsive table-hover table-striped">
            <thead>
                <tr class="text-center mb-1">
                    <td class="align-middle text-white py-2"
                        style="background: #1F51FF; border: none; border-top-left-radius: 5px; border-bottom-left-radius: 5px"></td>
                    <td class="align-middle text-white py-2"
                        style="background: #1F51FF; border: none">#</td>
                    <td class="align-middle text-white py-2"
                        style="background: #1F51FF; border: none"></td>
                    <td class="align-middle text-white py-2 ps-3 text-start"
                        style="background: #1F51FF; border: none">Team</td>
                    <td class="align-middle text-white py-2"
                        style="background: #1F51FF; border: none">Points</td>
                    <td class="align-middle text-white py-2 text-start"
                        style="background: #1F51FF; border: none; border-top-right-radius: 5px; border-bottom-right-radius: 5px"></td>
                </tr>
            </thead>
            <tbody>
                {% for ranking in rankings %}
                <tr>
                    <td class="col-1 text-center pe-0 align-middle small">
                        {% if ranking.rank_difference > 0 %}
                                <span class="align-items-center" style="color: green; background: #DDFFDD; border: 1px solid green; border-radius: 20px; padding: 2px 5px;">
                                    {{ ranking.rank_difference }}ðŸ¡©
                                </span>
                        {% elif team.rank_difference < 0 %}
                                <span class="align-items-center" style="color: #DB0000; background: #FFEEEE; border: 1px solid #DB0000; border-radius: 20px; padding: 2px 5px;">
                                    {{ ranking.rank_difference | stringformat:"d" | slice:"1:" }}ðŸ¡«
                                </span>
                        {% endif %}
                    </td>
                    <td class="text-center align-middle col-1 py-0 ps-3">
                        <span style="display: block; font-weight: 500; width: 40px !important; padding: 3px 5px">
                            {{ ranking.current_rank }}
                        </span>
                    </td>
                    <td class="align-middle py-1 col-1 text-end">
                        <img src="{{ ranking.team.flag_url }}"
                             alt="{{ ranking.team.name }}"
                             class=""
                             style="width: 36px; height: 24px; border: 1px solid black; background: #c5aa6a; border-radius: 3px"
                             loading="lazy">
                    </td>
                    <td class="col-5 align-middle">
                        <span class="ms-2 align-items-center text-dark" style="font-size: 0.98rem">
                            {{ ranking.team.name }}
                        </span>
                    </td>
                    <td class="py-1 text-center col-2 align-middle"
                        style="font-size: 0.95rem; {% if team.points_difference != 0 %}font-weight: 400;{% endif %}">
                        {{ ranking.current_points | floatformat:2 }}
                    </td>
                    <td class="py-1 col-2 align-middle small">
                        {% if ranking.point_difference > 0 %}
                                <span class="align-items-center" style="color: green; background: #DDFFDD; border: 1px solid green; border-radius: 20px; padding: 2px 5px;">
                                +{{ ranking.point_difference | floatformat:2 }}
                                </span>
                        {% elif ranking.point_difference < 0 %}
                                <span class="align-items-center" style="color: #DB0000; background: #FFEEEE; border: 1px solid #DB0000; border-radius: 20px; padding: 2px 5px;">
                                {{ ranking.point_difference | floatformat:2 }}
                            </span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
{#        {% endcache %}#}
{% if not conf %}
    <p class="text-center fs-6 py-3">
            <a class="mx-1 px-2" href="{% url 'ranking' %}"
                   style="font-size: 0.95rem; text-decoration: none; font-weight: 500; color: white; padding: 3px 6px; background: #5F91FF; border-radius: 5px; line-height: 1; width: 100px !important; {% if not request.GET.page %}background: #1F51FF !important;{% endif %}">
                1</a><a class="mx-1 px-2" href="{% url 'ranking' %}?page=2"
                   style="font-size: 0.95rem; text-decoration: none; font-weight: 500; color: white; padding: 3px 6px; background: #5F91FF; border-radius: 5px; line-height: 1; {% if request.GET.page == '2' %}background: #1F51FF !important;{% endif %}">2</a><a class="mx-1 px-2" href="{% url 'ranking' %}?page=3"
                   style="font-size: 0.95rem; text-decoration: none; font-weight: 500; color: white; padding: 3px 6px; background: #5F91FF; border-radius: 5px; line-height: 1; {% if request.GET.page == '3' %}background: #1F51FF !important;{% endif %}">3</a>
        </p>
    {% endif %}
    </div>

    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SportsEvent",
  "name": "Live FIFA Rankings",
  "description": "Stay updated with RankFoot's live FIFA Men's Football Rankings. Get daily updates on national team standings, track performance changes in real-time, and follow the latest movements in global football rankings.",
  "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
  "eventStatus": "https://schema.org/EventScheduled",
  "startDate": "{{ current_date }}",
  "endDate": "{{ current_date }}",
  "location": {
    "@type": "Place",
    "name": "Global Football Stadium",
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Worldwide"
    }
  },
  "organizer": {
    "@type": "Organization",
    "name": "FIFA",
    "url": "https://www.fifa.com"
  },
  "offers": {
    "@type": "Offer",
    "url": "{{ request.build_absolute_uri }}",
    "price": "0",
    "priceCurrency": "USD",
    "validFrom": "{{ current_date }}",
    "availability": "https://schema.org/InStock"
  },
  "performer": [
    {% for team in teams %}
    {
      "@type": "SportsTeam",
      "name": "{{ team.name }}",
      "image": "{{ team.flag_url }}",
      "member": {
        "name": "FIFA"
      },
      "ranking": {
        "@type": "Place",
        "name": "{{ team.current_rank }}",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "{{ team.name }}"
        }
      },
      "points": "{{ team.current_points | floatformat:2 }}"
    }{% if not forloop.last %},{% endif %}
    {% endfor %}
  ]
}
</script>

{% endblock %}
